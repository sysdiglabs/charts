apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  annotations:
    alm-examples: |-
      [
        {
          "apiVersion": "shield.sysdig.com/v1alpha1",
          "kind": "Shield",
          "metadata": {
            "name": "shield-sample"
          },
          "spec": {
            "affinity": {},
            "cluster": {
              "additional_settings": {
                "log_level": "info",
                "monitoring_port": 8080
              },
              "admissionregistration": {
                "create": true
              },
              "affinity": {},
              "dns_policy": null,
              "enable_prometheus_scraping": true,
              "env": [],
              "host_network": false,
              "image": {
                "pull_policy": "IfNotPresent",
                "pull_secrets": [],
                "registry": "quay.io",
                "repository": "sysdig/cluster-shield",
                "tag": "1.4.0"
              },
              "node_selector": {},
              "pod_annotations": {},
              "pod_labels": {},
              "priority_class": {
                "annotations": {},
                "create": false,
                "labels": {},
                "name": null,
                "value": 10
              },
              "probes": {
                "liveness": {
                  "failureThreshold": 9,
                  "initialDelaySeconds": 5,
                  "periodSeconds": 5
                },
                "readiness": {
                  "failureThreshold": 9,
                  "initialDelaySeconds": 10,
                  "periodSeconds": 5
                }
              },
              "rbac": {
                "annotations": {},
                "create": true,
                "labels": {},
                "service_account_name": null
              },
              "replica_count": 2,
              "resources": {
                "limits": {
                  "cpu": "1500m",
                  "memory": "1536Mi"
                },
                "requests": {
                  "cpu": "500m",
                  "memory": "512Mi"
                }
              },
              "run_mode": "multi-process",
              "tls_certificates": {
                "create": true,
                "secret_name": null
              },
              "tolerations": [],
              "update_strategy": {
                "rollingUpdate": {},
                "type": "RollingUpdate"
              },
              "volume_mounts": [],
              "volumes": [],
              "workload_annotations": {},
              "workload_labels": {}
            },
            "cluster_config": {
              "cluster_domain": "cluster.local",
              "cluster_type": "other",
              "name": "test",
              "root_namespace": "kube-system",
              "tags": {}
            },
            "env": [],
            "features": {
              "admission_control": {
                "container_vulnerability_management": {
                  "enabled": false
                },
                "deny_on_error": false,
                "dry_run": true,
                "enabled": false,
                "excluded_namespaces": [],
                "http_port": 8443,
                "timeout": 10
              },
              "detections": {
                "drift_control": {
                  "enabled": false
                },
                "kubernetes_audit": {
                  "enabled": false,
                  "excluded_namespaces": [],
                  "http_port": 6443,
                  "timeout": 10
                },
                "malware_control": {
                  "enabled": false
                },
                "ml_policies": {
                  "enabled": false
                }
              },
              "investigations": {
                "activity_audit": {
                  "enabled": false
                },
                "audit_tap": {
                  "enabled": false
                },
                "captures": {
                  "enabled": false
                },
                "event_forwarder": {
                  "enabled": false,
                  "integrations": [],
                  "transmit_message_types": []
                },
                "live_logs": {
                  "enabled": false
                },
                "network_security": {
                  "enabled": false
                }
              },
              "kubernetes_metadata": {
                "enabled": false
              },
              "monitoring": {
                "app_checks": {
                  "enabled": false
                },
                "java_management_extensions": {
                  "enabled": false
                },
                "prometheus": {
                  "enabled": false
                },
                "statsd": {
                  "enabled": false
                }
              },
              "posture": {
                "cluster_posture": {
                  "enabled": false
                },
                "host_posture": {
                  "enabled": false
                }
              },
              "responding": {
                "rapid_response": {
                  "enabled": false
                }
              },
              "vulnerability_management": {
                "container_vulnerability_management": {
                  "enabled": false,
                  "local_cluster": {
                    "registry_secrets": []
                  },
                  "platform_services_enabled": true,
                  "registry_ssl": {
                    "verify": true
                  }
                },
                "host_vulnerability_management": {
                  "enabled": false
                },
                "in_use": {
                  "enabled": false,
                  "integration_enabled": false
                }
              }
            },
            "fullname_override": null,
            "host": {
              "additional_settings": {},
              "affinity": {
                "nodeAffinity": {
                  "requiredDuringSchedulingIgnoredDuringExecution": {
                    "nodeSelectorTerms": [
                      {
                        "matchExpressions": [
                          {
                            "key": "kubernetes.io/arch",
                            "operator": "In",
                            "values": [
                              "amd64",
                              "arm64",
                              "ppc64le",
                              "s390x"
                            ]
                          },
                          {
                            "key": "kubernetes.io/os",
                            "operator": "In",
                            "values": [
                              "linux"
                            ]
                          }
                        ]
                      }
                    ]
                  }
                }
              },
              "driver": "kmod",
              "env": [],
              "image": {
                "kmodule_name": "agent-kmodule",
                "pull_policy": "IfNotPresent",
                "pull_secrets": [],
                "registry": "quay.io",
                "repository": "sysdig",
                "shield_name": "agent-slim",
                "tag": "13.4.0"
              },
              "node_selector": {},
              "pod_annotations": {},
              "pod_labels": {},
              "priority_class": {
                "annotations": {},
                "create": false,
                "labels": {},
                "name": null,
                "value": 10
              },
              "privileged": true,
              "probes": {
                "liveness": {
                  "failureThreshold": 9,
                  "initialDelaySeconds": 90,
                  "periodSeconds": 10
                },
                "readiness": {
                  "failureThreshold": 9,
                  "initialDelaySeconds": 90,
                  "periodSeconds": 10
                }
              },
              "rbac": {
                "annotations": {},
                "create": true,
                "labels": {},
                "service_account_name": null
              },
              "resources": {
                "kmodule": {
                  "limits": {
                    "cpu": "1000m",
                    "memory": "1Gi"
                  },
                  "requests": {
                    "cpu": "250m",
                    "memory": "384Mi"
                  }
                },
                "shield": {
                  "limits": {
                    "cpu": "1000m",
                    "memory": "1Gi"
                  },
                  "requests": {
                    "cpu": "250m",
                    "memory": "384Mi"
                  }
                }
              },
              "tolerations": [
                {
                  "effect": "NoSchedule",
                  "key": "node-role.kubernetes.io/master"
                },
                {
                  "effect": "NoSchedule",
                  "key": "node-role.kubernetes.io/control-plane"
                },
                {
                  "effect": "NoSchedule",
                  "key": "node-role.kubernetes.io/controlplane",
                  "operator": "Equal",
                  "value": "true"
                },
                {
                  "effect": "NoExecute",
                  "key": "node-role.kubernetes.io/etcd",
                  "operator": "Equal",
                  "value": "true"
                },
                {
                  "effect": "NoExecute",
                  "key": "CriticalAddonsOnly",
                  "operator": "Equal",
                  "value": "true"
                }
              ],
              "update_strategy": {
                "rollingUpdate": {},
                "type": "RollingUpdate"
              },
              "volume_mounts": [],
              "volumes": [],
              "workload_annotations": {},
              "workload_labels": {}
            },
            "name_override": null,
            "node_selector": {},
            "on_prem_version": null,
            "pod_annotations": {},
            "pod_labels": {},
            "proxy": {
              "http_proxy": null,
              "http_proxy_existing_secret": null,
              "https_proxy": null,
              "https_proxy_existing_secret": null,
              "no_proxy": null,
              "no_proxy_existing_secret": null
            },
            "ssl": {
              "ca": {
                "certs": [],
                "existing_ca_secret": null,
                "existing_ca_secret_key_name": null,
                "key_name": null
              },
              "verify": true
            },
            "sysdig_endpoint": {
              "access_key": "abcd",
              "access_key_existing_secret": null,
              "api_url": "https://x.com",
              "collector": {
                "host": "y.com",
                "port": 666
              },
              "region": "custom",
              "secure_api_token": null,
              "secure_api_token_existing_secret": null
            },
            "tolerations": [],
            "volume_mounts": [],
            "volumes": [],
            "workload_annotations": {},
            "workload_labels": {}
          }
        }
      ]
    capabilities: Basic Install
    createdAt: "2024-10-23T18:42:52Z"
    operators.operatorframework.io/builder: operator-sdk-v1.36.1
    operators.operatorframework.io/project_layout: helm.sdk.operatorframework.io/v1
  name: rh-shield-operator.v0.0.1
  namespace: placeholder
spec:
  apiservicedefinitions: {}
  customresourcedefinitions:
    owned:
    - kind: Shield
      name: shields.shield.sysdig.com
      version: v1alpha1
  description: Openshift Operator based on the shield Helm chart by Sysdig
  displayName: rh-shield-operator
  icon:
  - base64data: ""
    mediatype: ""
  install:
    spec:
      clusterPermissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - namespaces
          verbs:
          - get
        - apiGroups:
          - ""
          resources:
          - secrets
          verbs:
          - '*'
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - create
        - apiGroups:
          - shield.sysdig.com
          resources:
          - shields
          - shields/status
          - shields/finalizers
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - clusterrolebindings
          - clusterroles
          verbs:
          - '*'
        - apiGroups:
          - ""
          resources:
          - configmaps
          - secrets
          - serviceaccounts
          - services
          verbs:
          - '*'
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - rolebindings
          - roles
          verbs:
          - '*'
        - apiGroups:
          - apps
          resources:
          - daemonsets
          - deployments
          verbs:
          - '*'
        - apiGroups:
          - authentication.k8s.io
          resources:
          - tokenreviews
          verbs:
          - create
        - apiGroups:
          - authorization.k8s.io
          resources:
          - subjectaccessreviews
          verbs:
          - create
        serviceAccountName: rh-shield-operator-controller-manager
      deployments:
      - label:
          app.kubernetes.io/managed-by: kustomize
          app.kubernetes.io/name: rh-shield-operator
          control-plane: controller-manager
        name: rh-shield-operator-controller-manager
        spec:
          replicas: 1
          selector:
            matchLabels:
              control-plane: controller-manager
          strategy: {}
          template:
            metadata:
              annotations:
                kubectl.kubernetes.io/default-container: manager
              labels:
                control-plane: controller-manager
            spec:
              containers:
              - args:
                - --secure-listen-address=0.0.0.0:8443
                - --upstream=http://127.0.0.1:8080/
                - --logtostderr=true
                - --v=0
                image: gcr.io/kubebuilder/kube-rbac-proxy:v0.16.0
                name: kube-rbac-proxy
                ports:
                - containerPort: 8443
                  name: https
                  protocol: TCP
                resources:
                  limits:
                    cpu: 500m
                    memory: 128Mi
                  requests:
                    cpu: 5m
                    memory: 64Mi
                securityContext:
                  allowPrivilegeEscalation: false
                  capabilities:
                    drop:
                    - ALL
              - args:
                - --health-probe-bind-address=:8081
                - --metrics-bind-address=127.0.0.1:8080
                - --leader-elect
                - --leader-election-id=rh-shield-operator
                image: localhost:5000/rh-shield-operator:v0.0.1
                livenessProbe:
                  httpGet:
                    path: /healthz
                    port: 8081
                  initialDelaySeconds: 15
                  periodSeconds: 20
                name: manager
                readinessProbe:
                  httpGet:
                    path: /readyz
                    port: 8081
                  initialDelaySeconds: 5
                  periodSeconds: 10
                resources:
                  limits:
                    cpu: 500m
                    memory: 128Mi
                  requests:
                    cpu: 10m
                    memory: 64Mi
                securityContext:
                  allowPrivilegeEscalation: false
                  capabilities:
                    drop:
                    - ALL
              securityContext:
                runAsNonRoot: true
              serviceAccountName: rh-shield-operator-controller-manager
              terminationGracePeriodSeconds: 10
      permissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - create
          - patch
        serviceAccountName: rh-shield-operator-controller-manager
    strategy: deployment
  installModes:
  - supported: false
    type: OwnNamespace
  - supported: false
    type: SingleNamespace
  - supported: false
    type: MultiNamespace
  - supported: true
    type: AllNamespaces
  keywords:
  - sysdig
  - shield
  - security
  - monitoring
  links:
  - name: Rh Shield Operator
    url: https://rh-shield-operator.domain
  maintainers:
  - email: adam.roberts@sysdig.com
    name: Adam Roberts
  maturity: alpha
  provider:
    name: Sysdig
    url: https://sysdig.com
  version: 0.0.1
