# Shield

[Sysdig Shield](https://docs.sysdig.com/).
This chart deploys the Sysdig Host & Cluster Shield in your Kubernetes cluster.

- [Prerequisites](#prerequisites)
- [Installing the Chart](#installing-the-chart)
- [Configuration](#configuration)

## Introduction

This chart deploys the Sysdig Shield as a Deployment on a [Kubernetes](http://kubernetes.io) cluster using the [Helm](https://helm.sh) package manager.

### Prerequisites

- Helm 3.6
- Sysdig AccessKey
- Sysdig Secure API Token (required for Kubernetes Audit with on-premise installations)
- Sysdig Secure API URL
- Sysdig Secure Collector

### Installing the Chart

To install the chart  create a `values.yaml` file. Set your values and decide which features you would like to enable.
```yaml
cluster_config:
  name: <your-cluster-name>

sysdig_endpoint:
  access_key: <your-access-key>
  api_url: <your-api-url>
  collector:
    host: <your-collector-hostname>
    port: <your-collector-port>
```

Then, to install it with the release name `sysdig`, run:

```console
$ helm upgrade --install --atomic --create-namespace \
    -n sysdig-agent \
    -f values.yaml \
    sysdig \
    sysdig/shield
```

The command deploys the Sysdig Shield on the Kubernetes cluster in the default configuration. The [configuration](#configuration) section lists the parameters that can be configured during installation.

> **Tip**: List all releases using `helm list`

### Uninstalling the Chart

To uninstall/delete the `sysdig`:

```console
$ helm uninstall sysdig -n sysdig-agent
```

The command removes all the Kubernetes components associated with the chart and deletes the release.

## Configuration

The following table lists the configurable parameters of the `shield` chart and their default values.

|                                              Parameter                                              |                                                                                                                                                         Description                                                                                                                                                         |                                                                                                                                                                                                                   Default                                                                                                                                                                                                                    |
|-----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| cluster_config.name                                                                                 | The name of the cluster                                                                                                                                                                                                                                                                                                     | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| cluster_config.cluster_domain                                                                       | The domain of the cluster                                                                                                                                                                                                                                                                                                   | <code>cluster.local</code>                                                                                                                                                                                                                                                                                                                                                                                                                   |
| cluster_config.cluster_type                                                                         | The type of the cluster (Accepted Values: gke-autopilot, generic)                                                                                                                                                                                                                                                           | <code>generic</code>                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cluster_config.root_namespace                                                                       | The root namespace of the cluster                                                                                                                                                                                                                                                                                           | <code>kube-system</code>                                                                                                                                                                                                                                                                                                                                                                                                                     |
| cluster_config.tags                                                                                 | Tags you want to apply to the metadata sent to the Sysdig Backend.                                                                                                                                                                                                                                                          | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| sysdig_endpoint.region                                                                              | The region where the Sysdig Secure instance is located                                                                                                                                                                                                                                                                      | <code>custom</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| sysdig_endpoint.api_url                                                                             | The URL of the Sysdig Secure API (required only when region is custom)                                                                                                                                                                                                                                                      | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| sysdig_endpoint.collector.host                                                                      | The hostname of the Sysdig Secure collector (required only when region is custom)                                                                                                                                                                                                                                           | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| sysdig_endpoint.collector.port                                                                      | The port of the Sysdig Secure collector (required only when region is custom)                                                                                                                                                                                                                                               | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| sysdig_endpoint.access_key                                                                          | The access key for the Sysdig Secure instance                                                                                                                                                                                                                                                                               | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| sysdig_endpoint.access_key_existing_secret                                                          | The access key for the Sysdig Secure instance (existing secret)                                                                                                                                                                                                                                                             | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| sysdig_endpoint.secure_api_token                                                                    | The API token for the Sysdig Secure instance                                                                                                                                                                                                                                                                                | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| sysdig_endpoint.secure_api_token_existing_secret                                                    | The API token for the Sysdig Secure instance (existing secret)                                                                                                                                                                                                                                                              | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| features.admission_control.enabled                                                                  | Enable the admission control feature                                                                                                                                                                                                                                                                                        | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.admission_control.failure_policy                                                           | The policy to apply when a request is denied                                                                                                                                                                                                                                                                                | <code>Ignore</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| features.admission_control.dry_run                                                                  | Enable the dry run mode                                                                                                                                                                                                                                                                                                     | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| features.admission_control.timeout                                                                  | The timeout for the admission control feature                                                                                                                                                                                                                                                                               | <code>10</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.admission_control.http_port                                                                | The port that will be used to expose admission control endpoints                                                                                                                                                                                                                                                            | <code>8443</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| features.admission_control.excluded_namespaces                                                      | The list of namespaces that will be excluded from the admission control                                                                                                                                                                                                                                                     | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.admission_control.container_vulnerability_management.enabled                               | Enable the container vulnerability management feature on the admission control                                                                                                                                                                                                                                              | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.admission_control.posture.enabled                                                          | Enable the posture feature on the admission control                                                                                                                                                                                                                                                                         | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| features.admission_control.supply_chain.enabled                                                     | Enable the supply chain feature on the admission control                                                                                                                                                                                                                                                                    | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.admission_control.supply_chain.image_signature.enabled                                     |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.admission_control.supply_chain.image_signature.cosign.mirror                               | The URL of The Update Framework (TUF) server used for retrieving sigstore-compliant trust information. If not specified, the default public sigstore TUF url will be used.                                                                                                                                                  | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| features.admission_control.supply_chain.image_signature.cosign.root                                 | The filepath or URL where an out-of-the-band copy of The Update Framework (TUF) root JSON file is available. In case a filepath is used, it can be made available through a custom volume mount pointing at a dedicated secret and/or configmap.                                                                            | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| features.admission_control.supply_chain.image_signature.cosign.root_checksum                        | The checksum for The Update Framework (TUF) root JSON file. Checksum value should be in the format: <algorithm>:<value> where supported algorithms are: sha256 and sha512. If no algorithm is specified, sha256 will be used.                                                                                               | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| features.kubernetes_metadata.enabled                                                                | Enable the Kubernetes Metadata feature on cluster shield                                                                                                                                                                                                                                                                    | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| features.posture.host_posture.enabled                                                               |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.posture.cluster_posture.enabled                                                            | Enable the posture feature on cluster shield                                                                                                                                                                                                                                                                                | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.vulnerability_management.host_vulnerability_management.enabled                             |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.vulnerability_management.container_vulnerability_management.enabled                        | Enable the container vulnerability management feature on cluster shield                                                                                                                                                                                                                                                     | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.vulnerability_management.container_vulnerability_management.local_cluster.registry_secrets | Restrict access to specific Docker secrets when Cluster Scanner is running. The default behavior is listing all secrets.                                                                                                                                                                                                    | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.vulnerability_management.container_vulnerability_management.platform_services_enabled      | Define if the platform services are enabled                                                                                                                                                                                                                                                                                 | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| features.vulnerability_management.container_vulnerability_management.registry_ssl.verify            | If set to false it allows insecure connections to registries, Such as for registries with self-signed or private certificates.                                                                                                                                                                                              | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| features.vulnerability_management.in_use.enabled                                                    | Allows to retrieve the list of running packages.                                                                                                                                                                                                                                                                            | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.vulnerability_management.in_use.integration_enabled                                        | Allows to store the list of running packages to Sysdig backend.                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.detections.drift_control.enabled                                                           |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.detections.malware_control.enabled                                                         |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.detections.ml_policies.enabled                                                             |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.detections.kubernetes_audit.enabled                                                        | Enable the Kubernetes Audit feature on cluster shield                                                                                                                                                                                                                                                                       | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.detections.kubernetes_audit.timeout                                                        | The timeout for the audit feature                                                                                                                                                                                                                                                                                           | <code>10</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.detections.kubernetes_audit.http_port                                                      | The port that will be used to expose the audit endpoints                                                                                                                                                                                                                                                                    | <code>6443</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| features.detections.kubernetes_audit.excluded_namespaces                                            | The list of namespaces that will be excluded from the audit feature                                                                                                                                                                                                                                                         | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.detections.kubernetes_audit.webhook_rules                                                  | List of rules used to determine if a request should be audited                                                                                                                                                                                                                                                              | <code>[{"apiGroups":["","apps","autoscaling","batch","networking.k8s.io","rbac.authorization.k8s.io","extensions"],"apiVersions":["*"],"operations":["*"],"resources":["*/*"],"scope":"*"}]</code>                                                                                                                                                                                                                                           |
| features.investigations.activity_audit.enabled                                                      |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.investigations.live_logs.enabled                                                           |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.investigations.network_security.enabled                                                    | Enable the network security feature                                                                                                                                                                                                                                                                                         | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.investigations.audit_tap.enabled                                                           |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.investigations.captures.enabled                                                            |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.investigations.event_forwarder.enabled                                                     |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.investigations.event_forwarder.integrations                                                |                                                                                                                                                                                                                                                                                                                             | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.investigations.event_forwarder.transmit_message_types                                      |                                                                                                                                                                                                                                                                                                                             | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.investigations.event_forwarder.existing_secret                                             | If existing_secret is set to anything different than an empty string the local forwarder secret generation is skipped and the existing secret name is used to mount the secret volume instead of the one defined in the secrets template                                                                                    | <code>""</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.respond.rapid_response.enabled                                                             |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.respond.rapid_response.password                                                            |                                                                                                                                                                                                                                                                                                                             | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| features.respond.rapid_response.password_existing_secret                                            | The name of the existing Rapid Response password secret                                                                                                                                                                                                                                                                     | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| features.respond.rapid_response.password_existing_secret_key                                        | The key used in the existing Rapid Response secret for the password (default: password)                                                                                                                                                                                                                                     | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| features.respond.response_actions.enabled                                                           |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.monitor.app_checks.enabled                                                                 |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.monitor.java_management_extensions.enabled                                                 |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.monitor.prometheus.enabled                                                                 |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.monitor.prometheus.prometheus_yaml                                                         | The content of the prometheus.yaml file                                                                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| features.monitor.statsd.enabled                                                                     |                                                                                                                                                                                                                                                                                                                             | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.monitor.kube_state_metrics.enabled                                                         | Enable the Kubernetes State Metrics feature                                                                                                                                                                                                                                                                                 | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| features.monitor.kubernetes_events.enabled                                                          | Enable the Kubernetes Events feature                                                                                                                                                                                                                                                                                        | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host_windows.enabled                                                                                | Enable the host shield for Windows                                                                                                                                                                                                                                                                                          | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host_windows.additional_settings.monitoring_port                                                    |                                                                                                                                                                                                                                                                                                                             | <code>8081</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| host_windows.agent_runtime_additional_settings                                                      | Additional settings to be passed to the agent-runtime component (overrides dragent.yaml generated by helm)                                                                                                                                                                                                                  | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.image.registry                                                                         | The registry where the host shield images are stored                                                                                                                                                                                                                                                                        | <code>quay.io</code>                                                                                                                                                                                                                                                                                                                                                                                                                         |
| host_windows.image.repository                                                                       | The repository where the host shield images are stored                                                                                                                                                                                                                                                                      | <code>sysdig</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| host_windows.image.name                                                                             | The image name for the host shield                                                                                                                                                                                                                                                                                          | <code>host-shield</code>                                                                                                                                                                                                                                                                                                                                                                                                                     |
| host_windows.image.tag                                                                              | The tag for the host shield images                                                                                                                                                                                                                                                                                          | <code>0.12.1</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| host_windows.image.pull_policy                                                                      | The pull policy for the host shield images                                                                                                                                                                                                                                                                                  | <code>IfNotPresent</code>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| host_windows.image.pull_secrets                                                                     | The pull secrets for the host shield images                                                                                                                                                                                                                                                                                 | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.resources.limits.cpu                                                                   | The CPU limit for the host shield                                                                                                                                                                                                                                                                                           | <code>1000m</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host_windows.resources.limits.memory                                                                | The memory limit for the host shield                                                                                                                                                                                                                                                                                        | <code>1Gi</code>                                                                                                                                                                                                                                                                                                                                                                                                                             |
| host_windows.resources.requests.cpu                                                                 | The CPU request for the host shield                                                                                                                                                                                                                                                                                         | <code>250m</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| host_windows.resources.requests.memory                                                              | The memory request for the host shield                                                                                                                                                                                                                                                                                      | <code>384Mi</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host_windows.host_aliases                                                                           | The host aliases for the windows host shield workloads                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.workload_annotations                                                                   | The annotations for the host shield workloads (metadata.annotations)                                                                                                                                                                                                                                                        | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.workload_labels                                                                        | The labels for the host shield workloads (metadata.labels)                                                                                                                                                                                                                                                                  | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.pod_annotations                                                                        | The annotations for the host shield pods (spec.template.metadata.annotations)                                                                                                                                                                                                                                               | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.pod_labels                                                                             | The labels for the host shield pods (spec.template.metadata.labels)                                                                                                                                                                                                                                                         | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.node_selector.kubernetes.io/os                                                         |                                                                                                                                                                                                                                                                                                                             | <code>windows</code>                                                                                                                                                                                                                                                                                                                                                                                                                         |
| host_windows.affinity                                                                               | The affinity for the host shield                                                                                                                                                                                                                                                                                            | <code>{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"kubernetes.io/arch","operator":"In","values":["amd64"]},{"key":"kubernetes.io/os","operator":"In","values":["windows"]}]}]}}}</code>                                                                                                                                                                              |
| host_windows.update_strategy.type                                                                   | The update strategy                                                                                                                                                                                                                                                                                                         | <code>RollingUpdate</code>                                                                                                                                                                                                                                                                                                                                                                                                                   |
| host_windows.update_strategy.rollingUpdate                                                          |                                                                                                                                                                                                                                                                                                                             | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.env                                                                                    | The custom environment variables for the host shield                                                                                                                                                                                                                                                                        | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.volumes                                                                                | The custom volumes for the host shield                                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host_windows.volume_mounts                                                                          | The custom volume mounts for the host shield                                                                                                                                                                                                                                                                                | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.driver                                                                                         | The driver to use for the host agent (Accepted Values: kmod, legacy_ebpf, universal_ebpf)                                                                                                                                                                                                                                   | <code>kmod</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| host.additional_settings                                                                            | Additional settings to be passed to host-shield (overrides dragent.yaml generated by helm)                                                                                                                                                                                                                                  | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.security_context                                                                               | Allows overriding the Security Context of the Agent pod(s). Primarily intended resolving targeted incidents and debugging                                                                                                                                                                                                   | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.image.registry                                                                                 | The registry where the host shield images are stored                                                                                                                                                                                                                                                                        | <code>quay.io</code>                                                                                                                                                                                                                                                                                                                                                                                                                         |
| host.image.repository                                                                               | The repository where the host shield images are stored                                                                                                                                                                                                                                                                      | <code>sysdig</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| host.image.kmodule_name                                                                             | The image name for the host shield kmodule drive                                                                                                                                                                                                                                                                            | <code>agent-kmodule</code>                                                                                                                                                                                                                                                                                                                                                                                                                   |
| host.image.shield_name                                                                              | The image name for the host shield                                                                                                                                                                                                                                                                                          | <code>agent-slim</code>                                                                                                                                                                                                                                                                                                                                                                                                                      |
| host.image.tag                                                                                      | The tag for the host shield images                                                                                                                                                                                                                                                                                          | <code>14.2.3</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| host.image.pull_policy                                                                              | The pull policy for the host shield images                                                                                                                                                                                                                                                                                  | <code>IfNotPresent</code>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| host.image.pull_secrets                                                                             | The pull secrets for the host shield images                                                                                                                                                                                                                                                                                 | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.priority_class.create                                                                          | Create a priority class for the host shield                                                                                                                                                                                                                                                                                 | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host.priority_class.name                                                                            | The name of the priority class (if create is set to false, this will be used as the name of the existing priority class)                                                                                                                                                                                                    | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| host.priority_class.value                                                                           | The value of the priority class                                                                                                                                                                                                                                                                                             | <code>10</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.priority_class.labels                                                                          | The labels for the priority class                                                                                                                                                                                                                                                                                           | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.priority_class.annotations                                                                     | The annotations for the priority class                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.privileged                                                                                     | Sets the host shield to run in privileged mode. Disabling requires the use of the Universal eBPF driver. Must be enabled for Posture and Vulnerability Management functionalities.                                                                                                                                          | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| host.rbac.create                                                                                    | Create the RBAC resources for the host shield                                                                                                                                                                                                                                                                               | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| host.rbac.service_account_name                                                                      | The name of the service account for the host shield (if create is set to false, this will be used as the name of the existing service account)                                                                                                                                                                              | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| host.rbac.labels                                                                                    | The labels for the service account                                                                                                                                                                                                                                                                                          | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.rbac.annotations                                                                               | The annotations for the service account                                                                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.resources.kmodule.limits.cpu                                                                   | The CPU limit for the kmodule                                                                                                                                                                                                                                                                                               | <code>1000m</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host.resources.kmodule.limits.memory                                                                | The memory limit for the kmodule                                                                                                                                                                                                                                                                                            | <code>1Gi</code>                                                                                                                                                                                                                                                                                                                                                                                                                             |
| host.resources.kmodule.requests.cpu                                                                 | The CPU request for the kmodule                                                                                                                                                                                                                                                                                             | <code>250m</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| host.resources.kmodule.requests.memory                                                              | The memory request for the kmodule                                                                                                                                                                                                                                                                                          | <code>384Mi</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host.resources.shield.limits.cpu                                                                    | The CPU limit for the host shield                                                                                                                                                                                                                                                                                           | <code>1000m</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host.resources.shield.limits.memory                                                                 | The memory limit for the host shield                                                                                                                                                                                                                                                                                        | <code>1Gi</code>                                                                                                                                                                                                                                                                                                                                                                                                                             |
| host.resources.shield.requests.cpu                                                                  | The CPU request for the host shield                                                                                                                                                                                                                                                                                         | <code>250m</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| host.resources.shield.requests.memory                                                               | The memory request for the host shield                                                                                                                                                                                                                                                                                      | <code>384Mi</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| host.host_aliases                                                                                   | The host aliases for the linux host shield workloads                                                                                                                                                                                                                                                                        | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.workload_annotations                                                                           | The annotations for the host shield workloads (metadata.annotations)                                                                                                                                                                                                                                                        | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.workload_labels                                                                                | The labels for the host shield workloads (metadata.labels)                                                                                                                                                                                                                                                                  | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.pod_annotations                                                                                | The annotations for the host shield pods (spec.template.metadata.annotations)                                                                                                                                                                                                                                               | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.pod_labels                                                                                     | The labels for the host shield pods (spec.template.metadata.labels)                                                                                                                                                                                                                                                         | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.node_selector                                                                                  | The node selector for the host shield                                                                                                                                                                                                                                                                                       | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.tolerations                                                                                    | The tolerations for the host shield                                                                                                                                                                                                                                                                                         | <code>[{"effect":"NoSchedule","key":"node-role.kubernetes.io/master"},{"effect":"NoSchedule","key":"node-role.kubernetes.io/control-plane"},{"effect":"NoSchedule","key":"node-role.kubernetes.io/controlplane","operator":"Equal","value":"true"},{"effect":"NoExecute","key":"node-role.kubernetes.io/etcd","operator":"Equal","value":"true"},{"effect":"NoExecute","key":"CriticalAddonsOnly","operator":"Equal","value":"true"}]</code> |
| host.affinity                                                                                       | The affinity for the host shield                                                                                                                                                                                                                                                                                            | <code>{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"kubernetes.io/arch","operator":"In","values":["amd64","arm64","ppc64le","s390x"]},{"key":"kubernetes.io/os","operator":"In","values":["linux"]}]}]}}}</code>                                                                                                                                                      |
| host.probes.readiness.initialDelaySeconds                                                           | The readiness probe initial delay                                                                                                                                                                                                                                                                                           | <code>90</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.probes.readiness.periodSeconds                                                                 | The readiness probe period                                                                                                                                                                                                                                                                                                  | <code>10</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.probes.readiness.failureThreshold                                                              | The readiness probe failure threshold                                                                                                                                                                                                                                                                                       | <code>9</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| host.probes.liveness.initialDelaySeconds                                                            | The liveness probe initial delay                                                                                                                                                                                                                                                                                            | <code>90</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.probes.liveness.periodSeconds                                                                  | The liveness probe period                                                                                                                                                                                                                                                                                                   | <code>10</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.probes.liveness.failureThreshold                                                               | The readiness probe failure threshold                                                                                                                                                                                                                                                                                       | <code>9</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| host.update_strategy.type                                                                           | The update strategy                                                                                                                                                                                                                                                                                                         | <code>RollingUpdate</code>                                                                                                                                                                                                                                                                                                                                                                                                                   |
| host.update_strategy.rollingUpdate                                                                  |                                                                                                                                                                                                                                                                                                                             | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.env                                                                                            | The custom environment variables for the host shield                                                                                                                                                                                                                                                                        | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.volumes                                                                                        | The custom volumes for the host shield                                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.volume_mounts                                                                                  | The custom volume mounts for the host shield                                                                                                                                                                                                                                                                                | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| host.dns_policy                                                                                     | The dns policy for the host shield                                                                                                                                                                                                                                                                                          | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| cluster.image.registry                                                                              | The registry where the cluster shield image is stored                                                                                                                                                                                                                                                                       | <code>quay.io</code>                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cluster.image.repository                                                                            | The repository where the cluster shield image is stored                                                                                                                                                                                                                                                                     | <code>sysdig/cluster-shield</code>                                                                                                                                                                                                                                                                                                                                                                                                           |
| cluster.image.tag                                                                                   | The tag for the cluster shield image                                                                                                                                                                                                                                                                                        | <code>1.16.1</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| cluster.image.pull_policy                                                                           | The pull policy for the cluster shield image                                                                                                                                                                                                                                                                                | <code>IfNotPresent</code>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| cluster.image.pull_secrets                                                                          | The pull secrets for the cluster shield image                                                                                                                                                                                                                                                                               | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.run_mode                                                                                    | The mode in which the cluster shield should run (Accepted Values: single-process, multi-process)                                                                                                                                                                                                                            | <code>multi-process</code>                                                                                                                                                                                                                                                                                                                                                                                                                   |
| cluster.priority_class.create                                                                       | Create a priority class for the cluster shield                                                                                                                                                                                                                                                                              | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| cluster.priority_class.name                                                                         | The name of the priority class (if create is set to false, this will be used as the name of the existing priority class)                                                                                                                                                                                                    | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| cluster.priority_class.value                                                                        | The value of the priority class                                                                                                                                                                                                                                                                                             | <code>10</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.priority_class.labels                                                                       | The labels for the priority class                                                                                                                                                                                                                                                                                           | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.priority_class.annotations                                                                  | The annotations for the priority class                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.rbac.create                                                                                 | Create the RBAC resources for the cluster shield                                                                                                                                                                                                                                                                            | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.rbac.service_account_name                                                                   | The name of the service account for the cluster shield (if create is set to false, this will be used as the name of the existing service account)                                                                                                                                                                           | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| cluster.rbac.labels                                                                                 | The labels for the service account                                                                                                                                                                                                                                                                                          | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.rbac.annotations                                                                            | The annotations for the service account                                                                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.service.type                                                                                | The Cluster Shield service type                                                                                                                                                                                                                                                                                             | <code>ClusterIP</code>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| cluster.service.labels                                                                              | Additional service labels                                                                                                                                                                                                                                                                                                   | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.service.annotations                                                                         | Additional service annotations                                                                                                                                                                                                                                                                                              | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.security_context                                                                            | The default security context of the cluster shield pods                                                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.validatingwebhookconfiguration.create                                                       | Create the validatingwebhookconfiguration resources for the cluster shield                                                                                                                                                                                                                                                  | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.tls_certificates.create                                                                     | Create the TLS certificates for the cluster shield                                                                                                                                                                                                                                                                          | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.tls_certificates.secret_name                                                                | The name of the secret that contains the TLS certificates                                                                                                                                                                                                                                                                   | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| cluster.resources.requests.cpu                                                                      | The CPU request for the cluster shield                                                                                                                                                                                                                                                                                      | <code>500m</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.resources.requests.memory                                                                   | The memory request for the cluster shield                                                                                                                                                                                                                                                                                   | <code>512Mi</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| cluster.resources.limits.cpu                                                                        | The CPU limit for the cluster shield                                                                                                                                                                                                                                                                                        | <code>1500m</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| cluster.resources.limits.memory                                                                     | The memory limit for the cluster shield                                                                                                                                                                                                                                                                                     | <code>1536Mi</code>                                                                                                                                                                                                                                                                                                                                                                                                                          |
| cluster.host_aliases                                                                                | The host aliases for the cluster shield workloads                                                                                                                                                                                                                                                                           | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.workload_annotations                                                                        | The annotations for the cluster shield workloads (metadata.annotations)                                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.workload_labels                                                                             | The labels for the cluster shield workloads (metadata.labels)                                                                                                                                                                                                                                                               | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.pod_annotations                                                                             | The annotations for the cluster shield pods (spec.template.metadata.annotations)                                                                                                                                                                                                                                            | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.pod_labels                                                                                  | The labels for the cluster shield pods (spec.template.metadata.labels)                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.node_selector                                                                               | The node selector for the cluster shield                                                                                                                                                                                                                                                                                    | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.tolerations                                                                                 | The tolerations for the cluster shield                                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.affinity                                                                                    | The affinity for the cluster shield                                                                                                                                                                                                                                                                                         | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.additional_settings.log_level                                                               |                                                                                                                                                                                                                                                                                                                             | <code>info</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.additional_settings.monitoring_port                                                         |                                                                                                                                                                                                                                                                                                                             | <code>8080</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.enable_prometheus_scraping                                                                  | Automatically adds the Prometheus annotations to the Cluster Shield pods                                                                                                                                                                                                                                                    | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.probes.readiness.initialDelaySeconds                                                        | The readiness probe initial delay                                                                                                                                                                                                                                                                                           | <code>10</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.probes.readiness.periodSeconds                                                              | The readiness probe period                                                                                                                                                                                                                                                                                                  | <code>5</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| cluster.probes.readiness.failureThreshold                                                           | The readiness probe failure threshold                                                                                                                                                                                                                                                                                       | <code>9</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| cluster.probes.liveness.initialDelaySeconds                                                         | The liveness probe initial delay                                                                                                                                                                                                                                                                                            | <code>5</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| cluster.probes.liveness.periodSeconds                                                               | The liveness probe period                                                                                                                                                                                                                                                                                                   | <code>5</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| cluster.probes.liveness.failureThreshold                                                            | The readiness probe failure threshold                                                                                                                                                                                                                                                                                       | <code>9</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| cluster.replica_count                                                                               | The number of replicas for the cluster shield                                                                                                                                                                                                                                                                               | <code>2</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| cluster.update_strategy.type                                                                        | The update strategy                                                                                                                                                                                                                                                                                                         | <code>RollingUpdate</code>                                                                                                                                                                                                                                                                                                                                                                                                                   |
| cluster.update_strategy.rollingUpdate                                                               |                                                                                                                                                                                                                                                                                                                             | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.host_network                                                                                | Specifies if Cluster Shield should be started in hostNetwork mode. This field is required if you are using a custom CNI where the control plane nodes are unable to initiate network connections to the pods, for example, using Calico CNI plugin on EKS.                                                                  | <code>false</code>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| cluster.dns_policy                                                                                  | Define Cluster Shield Pods DNS Policy                                                                                                                                                                                                                                                                                       | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| cluster.env                                                                                         | The custom environment variables for cluster shield                                                                                                                                                                                                                                                                         | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.volumes                                                                                     | The custom volumes for cluster shield                                                                                                                                                                                                                                                                                       | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.volume_mounts                                                                               | The custom volume mounts for cluster shield                                                                                                                                                                                                                                                                                 | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| cluster.pod_disruption_budget.create                                                                | Create the PodDisruptionBudget for the cluster shield                                                                                                                                                                                                                                                                       | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| cluster.pod_disruption_budget.min_available                                                         | The minimum number of available pods for the cluster shield                                                                                                                                                                                                                                                                 | <code>1</code>                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ssl.verify                                                                                          | Enable SSL verification                                                                                                                                                                                                                                                                                                     | <code>true</code>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ssl.ca.certs                                                                                        | For outbound connections (secure backend, proxy,...) A PEM-encoded x509 certificate.  This can also be a bundle with multiple certificates.                                                                                                                                                                                 | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ssl.ca.key_name                                                                                     | Filename that is used when creating the secret.  Required if cert is provided.                                                                                                                                                                                                                                              | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ssl.ca.existing_ca_secret                                                                           | Provide the name of an existing Secret that contains the CA required                                                                                                                                                                                                                                                        | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ssl.ca.existing_ca_secret_key_name                                                                  | Provide the filename that is defined inside the existing Secret                                                                                                                                                                                                                                                             | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| proxy.http_proxy                                                                                    | HTTP proxy to use for all HTTP requests                                                                                                                                                                                                                                                                                     | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| proxy.http_proxy_existing_secret                                                                    | Provide the name of an existing Secret that contains the HTTP proxy                                                                                                                                                                                                                                                         | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| proxy.https_proxy                                                                                   | HTTPS proxy to use for all HTTPS requests                                                                                                                                                                                                                                                                                   | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| proxy.https_proxy_existing_secret                                                                   | Provide the name of an existing Secret that contains the HTTPS proxy                                                                                                                                                                                                                                                        | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| proxy.no_proxy                                                                                      | No proxy hosts and ips                                                                                                                                                                                                                                                                                                      | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| proxy.no_proxy_existing_secret                                                                      | Provide the name of an existing Secret that contains the no proxy hosts                                                                                                                                                                                                                                                     | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extra_capabilities_api_versions                                                                     | Additional .APIVersions in .Capabilities, e.g. "security.openshift.io/v1"                                                                                                                                                                                                                                                   | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| workload_annotations                                                                                | Additional annotations for the all the workloads (metadata.annotations)                                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| workload_labels                                                                                     | Additional labels for the all the workloads (metadata.labels)                                                                                                                                                                                                                                                               | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| pod_annotations                                                                                     | Additional annotations for all the pods (spec.template.metadata.annotations)                                                                                                                                                                                                                                                | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| pod_labels                                                                                          | Additional labels for all the pods (spec.template.metadata.labels)                                                                                                                                                                                                                                                          | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| node_selector                                                                                       | The node selector for the all the workloads                                                                                                                                                                                                                                                                                 | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| tolerations                                                                                         | The tolerations for the all the workloads                                                                                                                                                                                                                                                                                   | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| affinity                                                                                            | The affinity for the all the workloads                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| env                                                                                                 | The environment variables for the all the workloads                                                                                                                                                                                                                                                                         | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| volumes                                                                                             | The volumes to mount for all the workloads                                                                                                                                                                                                                                                                                  | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| volume_mounts                                                                                       | The volume mounts for all the workloads                                                                                                                                                                                                                                                                                     | <code>[]</code>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| name_override                                                                                       | Overrides the default resource identifier ex. sysdig-<override>-cluster                                                                                                                                                                                                                                                     | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| fullname_override                                                                                   | Overrides the default full resource identifier ex. <override>-cluster                                                                                                                                                                                                                                                       | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| on_prem_version                                                                                     | Optional parameter used to check the compatibility of shield component versions with the on-premised backend version. If you are running an on-prem version of the Sysdig backend, you MUST set this parameter with the version of Sysdig backend you are using. If you are runinng on SaaS, do NOT provide this parameter. | <code></code>                                                                                                                                                                                                                                                                                                                                                                                                                                |
