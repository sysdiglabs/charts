{{- if (include "host.rapid_response_enabled" .) }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "host.rapid_response_secret" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "host.labels" . | nindent 4 }}
type: Opaque
data:
  password: {{ (include "host.rapid_response_password" .) | b64enc | quote }}
{{- end }}

{{- if and .Values.features.investigations.event_forwarder.enabled (eq .Values.features.investigations.event_forwarder.existing_secret_name "") }}
---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: {{ include "host.local_forwarder_secret_name" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "host.labels" . | nindent 4 }}
data:
  local_forwarder_config.yaml: {{ pick .Values.features.investigations.event_forwarder "integrations" | toYaml | b64enc | quote }}
{{- end }}
